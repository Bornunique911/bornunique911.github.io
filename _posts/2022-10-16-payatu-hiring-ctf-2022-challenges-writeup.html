---
layout: post
title: 'Payatu Hiring CTF 2022: Challenges Writeup'
canonical_url: https://bornunique911.medium.com/payatu-hiring-ctf-2022-challenges-writeup-87de06310e6d?source=rss-348ebd5cdb70------2
---

<figure><img alt="" src="https://cdn-images-1.medium.com/max/320/0*IAiIhxEN-y5LT_VU.png" /></figure><h4><strong><em>Babysqli, Stardust, EasyCalc, Mistake-1 and Mistake-2</em></strong></h4><p>Hello everyone, I hope you all are doing great things and learning&#39;s everyday just like me. So I hereby came with my new and fresh blog again on Payatu Hiring CTF challenges walkthroughs. I solved 8 challenges out of 30 challenges which consists of Babysqli, Stardust, EasyCalc, Mistake-1 and Mistake-2, Catch Me If You Can and so on and I secured 12th rank. I will be walking you through the challenges from Web and Network category which consists the following :</p><blockquote><strong><em>Web Challenges :</em></strong></blockquote><p>Babysqli</p><p>Stardust</p><p>EasyCalc</p><blockquote><strong><em>Network Challenges :</em></strong></blockquote><p>Mistake-1</p><p>Mistake-2</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*FmTTOJ9N0hDcs8gs-_XbQQ.png" /><figcaption>Payatu Hiring CTF Platform (<a href="https://ctf.payatu.com/">https://ctf.payatu.com/</a>)</figcaption></figure><blockquote><strong>Prizes For The Winners :</strong></blockquote><figure><img alt="" src="https://cdn-images-1.medium.com/max/892/1*RYjxBmBmSu5k6ZVe3-J6nw.png" /></figure><h3>Introduction :</h3><p><strong><em>Timeline of the CTF :</em></strong></p><blockquote>The CTF will start at <strong>9:00 AM on 15th October 2022 and end at 9:00 PM</strong> (12 Hours)</blockquote><blockquote>There are multiple tracks of challenges. Start with the one you are comfortable with and ride your way up to the top.</blockquote><blockquote>Do not attack the CTF platform or deliberately perform actions that might lead to the platform/challenges being unavailable for other players.</blockquote><p><strong><em>Rules</em></strong> :</p><blockquote>Any kind of flag sharing/cheating will lead to disqualification.</blockquote><blockquote>Any request to consider allotment of points for challenges solved but flag not submitted will not be entertained.</blockquote><blockquote>Winning / Being in the top list of the leaderboard will only help you land an interview with Payatu. You will have to clear the interviews to get the job offer.</blockquote><blockquote>This is an individual event, and team participation is not allowed.</blockquote><blockquote>Anyone can play the CTF, but the hiring is limited to only Indian Participants.</blockquote><p><strong><em>Let’s begin the writeup first with web challenges. Let’s get started.</em></strong></p><blockquote><strong><em>Web Category :-</em></strong></blockquote><h4><strong><em>Babysqli</em></strong>:-</h4><figure><img alt="" src="https://cdn-images-1.medium.com/max/545/1*j9VWdyEC-IB68lJ1jdF8pA.png" /><figcaption>Babysqli Challenge Description</figcaption></figure><p>Let’s start with <strong>Babysqli</strong> from <strong>Web challenge</strong>. First things first I visited the provided link to the challenge and I land at this page which is as under:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*efQShB88ixaWaOn3sj-2Ug.png" /><figcaption>Simple Login Page from <a href="http://babysqli.payatu.lol/">http://babysqli.payatu.lol/</a></figcaption></figure><p>By exploring the website for quite sometime, I noticed that it is vulnerable to MySQL Injection by looking at the source code which is mentioned at the end of the page.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*Lm2099G8kKeJVjttKANikw.png" /><figcaption>Source Code for MySQL database</figcaption></figure><p>So after looking at the source code the query field has equipped some filters which are as under :</p><pre>$query = &#39;SELECT * FROM users WHERE username=&quot;&#39;.$user.&#39;&quot; AND password=&quot;&#39;.$pass.&#39;&quot;&#39;;</pre><p>So if anyone who will run the payloads like this</p><pre>&#39; or 1 or &#39;</pre><pre>admin&#39; || &#39;1&#39; == &#39;1 </pre><pre>&#39; || &#39;1&#39;== &#39;1</pre><p>will tend fail as it is opposed by the filters equipped. So I have two options to exploit MySQL either by using automated tool called <a href="https://github.com/sqlmapproject/sqlmap"><strong><em>sqlmap</em></strong></a> or manual injection. So I used <a href="https://github.com/sqlmapproject/sqlmap"><strong><em>sqlmap</em></strong></a> for exploiting this type of SQL injection.</p><p>Firstly, I will enumerate forms by running following command :</p><pre>sqlmap -u http://babysqli.payatu.lol/ --forms</pre><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*4PmjmMt2CPZ9_I7iioGVXQ.png" /><figcaption>Enumerating Forms</figcaption></figure><p>Now, I took the next step to dump databases by running following command :</p><pre>sqlmap -u http://babysqli.payatu.lol/ --forms --dbs</pre><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*13FmJw2mo6uKMw1LTONjgg.png" /><figcaption>Enumerating Databases</figcaption></figure><p>Now after enumerating databases, I have to enumerate how many tables are there in a particular database but there are 3 databases to choose so which one to choose is a question standing. So I choose &quot;babysqli&quot;<strong><em> </em></strong>database because I feel that it may contain juicy data to extract like users, passwords, etc. So, now I will enumerate tables of database &quot;babysqli&quot;<strong><em> </em></strong>with the following command :</p><pre>sqlmap -u http://babysqli.payatu.lol/ --forms -D babysqli --tables</pre><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*SPE6Bq0vVuuOx0uFX34pZA.png" /><figcaption>Enumerating Tables</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*SPE6Bq0vVuuOx0uFX34pZA.png" /></figure><p>Now, as there is only one table called &quot;users&quot;<strong><em> </em></strong>we can enumerate the columns for a particular table by the following command :</p><pre>sqlmap -u http://babysqli.payatu.lol/ --forms -D babysqli -T users --columns</pre><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*PcjLe1bCeDiaNcYe-iGEMA.png" /><figcaption>Enumerating columns</figcaption></figure><p>Now, finally I will dump the data from the columns by following command :</p><pre>sqlmap -u http://babysqli.payatu.lol/ --forms -D babysqli -T users -C id,username,password --dump</pre><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*hX5C52VZCCC4QVAaKQ1ImA.png" /><figcaption>Got the password of all the users</figcaption></figure><p>But unfortunately none of them have flag inside their accounts. So, I basically copied the payload from the <a href="https://github.com/sqlmapproject/sqlmap"><strong><em>sqlmap</em></strong></a> output and successfully logged into by pasting the following payload in the username and password field for the account and I found the flag from the source code.</p><pre>xYPs&quot; UNION ALL SELECT NULL,CONCAT(0x7178626b71,0x6478697349625a4d527266625861596455566c704b4c714f65684777674d737145747a614b6a6159,0x7176707171),NULL#</pre><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*7sj2qWsIwC0uGGbBPOXs7A.png" /><figcaption>Congratulations message for solving the challenge</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*jUSFjEYY-NrJnGIDndCFnw.png" /><figcaption>Finally flag for BabySqli challenge was captured</figcaption></figure><p>Voila I have successfully captured the babysqli challenge flag with the help of sqlmap.</p><p>— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><h4>Stardust:-</h4><figure><img alt="" src="https://cdn-images-1.medium.com/max/543/1*KbdUKq_70o7vu8rsODVDsQ.png" /><figcaption>Stardust Challenge Description</figcaption></figure><p>Let’s start with <strong>Stardust</strong> from <strong>Web challenge</strong>. First things first I visited the provided link to the challenge and I land at this page which is as under:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*QsHrJq1OFEQ777bX2LM86Q.png" /><figcaption>Landing page of <a href="http://stardust.payatu.lol/">http://stardust.payatu.lol/</a></figcaption></figure><p>By exploring the website for quite sometime, I noticed that there are 6 chapters for Dev Wars which points to the different location on the main page. Let’s say for example if I clicked Chapter 1 from the main page it goes to different location which is (<a href="http://stardust.payatu.lol/chapter?episode=the+phantom+feature">http://stardust.payatu.lol/chapter?episode=the+phantom+feature</a>) in case of Chapter 1 and so on and so forth. Now when I visited Chapter 1 link there was one parameter which was important to look at and that was &quot;episode&quot;<strong><em>. </em></strong>So by looking at the Chapter 1 link (<a href="http://stardust.payatu.lol/chapter?episode=the+phantom+feature">http://stardust.payatu.lol/chapter?episode=the+phantom+feature</a>)</p><p>for sometime I noticed that it runs a episode of Chapter 1 and the page is at still showing the contents of the episode.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*_xsTDqyykYowfE0h0EbOnA.png" /><figcaption>Playing episode 1 from Chapter 1</figcaption></figure><p>So I decided that why not explore &quot;episode=&quot; parameter by giving &quot;{{9 * 9}}&quot;as payload and it gave the product of &quot;9 * 9&quot; which is 81 as output.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*WaB-8VpxvvDTMNf2-FqQ7A.png" /><figcaption>Product of 9 multiplied by 9</figcaption></figure><p>So by observing this I thought that the &quot;episode&quot; is vulnerable to <strong><em>SSTI</em></strong> vulnerability aka <strong><em>Server Side Template Injection</em></strong>. So I decided to exploit it via some SSTI payloads. So I decided to use a very good <a href="https://ctftime.org/writeup/11014"><strong><em>writeup</em></strong></a> from <a href="https://ctftime.org/event/672"><strong><em>HackIT CTF 2018</em></strong></a> on <a href="https://ctftime.org"><strong><em>ctftime.org</em></strong></a> published by the user <a href="https://ctftime.org/user/24696"><strong><em>kazkiti</em></strong></a><strong><em> </em></strong>on SSTI payloads which he explained everything very nicely in detail manner on how to identify the vulnerability to how to get the flag at the end by exploiting SSTI.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*zz5c-ak3LcuqQbVZi4xY-A.png" /><figcaption>Little glance of the CTF writeup published by the user <a href="https://ctftime.org/user/24696"><strong>kazkiti</strong></a><strong> </strong>on<strong> </strong><a href="https://ctftime.org"><strong>ctftime.org</strong></a></figcaption></figure><p>So first things first as I observed that the web application is vulnerable to SSTI, then I decided to follow along by reading the <a href="https://ctftime.org/writeup/11014"><strong><em>writeup</em></strong></a> thoroughly and</p><p>I moved further with the first payload which is &quot;{{__self__.__doc__}}&quot; by appending it to<strong><em> </em></strong>after<strong><em> </em></strong>&quot;episode=&quot; parameter whether the web application is using Jinja2 or not. Voila it successfully gave me a <strong><em>Jinja2</em></strong> error which is as under :</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*LgoFMS7UQBFWt1dOxTWoQQ.png" /><figcaption>Error confirms that it is Jinja2 running in the backend</figcaption></figure><p>So after confirming that it’s <strong><em>Jinja2</em></strong> I can either use <a href="https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection"><strong><em>HackTricks</em></strong></a> blog on SSTI payloads or the payloads which the <a href="https://ctftime.org/writeup/11014"><strong><em>writeup</em></strong></a> I discussed earlier have mentioned in their <a href="https://ctftime.org/writeup/11014"><strong><em>writeup</em></strong></a>. So, I will use the payloads<strong><em> </em></strong>which the<strong><em> </em></strong><a href="https://ctftime.org/writeup/11014"><strong><em>writeup</em></strong></a> which I discussed earlier have mentioned as a weapon as it gave us an idea how an SSTI is successfully exploited step-by-step. So as per the <a href="https://ctftime.org/writeup/11014"><strong><em>writeup</em></strong></a>, I used the second payload which is &quot;{{self}}&quot;<strong><em> </em></strong>after &quot;episode=&quot; as under :</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*EMAA8cjDMtyyL2ak5hLtlg.png" /><figcaption>Trying <strong>“{{self}}” as the second payload</strong></figcaption></figure><p>As I can observe here that it shows <strong><em>&lt;TemplateReference None&gt; </em></strong>as output when I typed &quot;{{self}}&quot;. So for more information, I would recommend to read the <a href="https://jinja.palletsprojects.com/en/2.11.x/api/"><strong><em>documentation</em></strong></a> on <a href="https://jinja.palletsprojects.com/en/2.11.x/api/#exceptions"><strong><em>Jinja2</em></strong></a> and a <a href="https://ctftime.org/writeup/10895"><strong><em>writeup</em></strong></a> where the same person who I have took the reference of has mentioned in their previous <a href="https://ctftime.org/writeup/10895"><strong><em>writeup</em></strong></a>.</p><p>Moving along I passed the third payload which is &quot;{{config}}&quot;<strong><em> </em></strong>after<strong><em> </em></strong>&quot;episode=&quot;<strong><em> </em></strong>I got the following as follows :</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*7OezV23RetZP3l-UqlbPQw.png" /><figcaption>Passing <strong>{{config}} </strong>as the third payload</figcaption></figure><p>Finally I have successfully captured the flag when I typed<strong><em> </em></strong>&quot;{{config}}&quot;<strong><em> </em></strong>as a parameter value. So the flag is as under :</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*AsReEuG_kLZIYUtRYlFx1Q.png" /><figcaption>Finally flag for Stardust challenge was captured</figcaption></figure><p>— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><h4>EasyCalc:-</h4><figure><img alt="" src="https://cdn-images-1.medium.com/max/543/1*76bUSzJb1LBPBQ0ryWfvgw.png" /><figcaption>EasyCalc Challenge Description</figcaption></figure><p>Let’s start with <strong>EasyCalc</strong> from <strong>Web category</strong>. First things first I visited the provided link to the challenge and I land at this page which is as under:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*49EuXdNY9Kt4C8WBwAMqoQ.png" /><figcaption>Landing page of <a href="http://easy-calc.payatu.lol/">http://easy-calc.payatu.lol/</a></figcaption></figure><p>By exploring the website for quite sometime, I noticed that it’s a simple page which has a calculator functionality to compute simple operations such as <strong>addition</strong>, <strong>subtraction</strong>, <strong>division</strong> and <strong>multiplication</strong> and trigonometric operations such as <strong>sin</strong>, <strong>cos</strong> and <strong>tan</strong>.</p><p>So I tried to google search the writeups of the any previous CTF’s if they have anything related to bypass this simple calculator functionality and I found some interesting results which are as under :</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*pDRWSn2d-UiwK80uaj3K4A.png" /><figcaption>Google Search Results for Simple Calculator CTF writeups</figcaption></figure><p>So later on I decided why not I should check the source code of the page and so I checked the source code and there I found some script tags which contains the following code:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*FRhQMpLYdvp8ddezQhCfIQ.png" /><figcaption>JavaScript Code</figcaption></figure><p>Also from the source code I found some important thing to note which is the input tag in which the value is nothing but I came across the word &quot;disabled&quot;.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*n-ZUgXYCIDTwACSj4dNO8w.png" /><figcaption>Interesting thing I noted here about why is disabled here.</figcaption></figure><p>After sometime I thought that why not make some changes in the input tag by adding &quot;enabled=enabled&quot;<strong><em> </em></strong>by removing<strong><em> </em></strong>&quot;disabled&quot;<strong><em> </em></strong>from<strong><em> </em></strong><em>the input tag by inspecting the element as in the view page source we can’t make any changes and let’s see what we get. We got following as output :</em></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*d-Ft3pVj_ouwOYGoqd9XLA.png" /><figcaption>Removing disabled and adding enabled in the input tag</figcaption></figure><p>And one other thing notice is that now I can type in the input whatever I want like alphabets,etc but it will throw an error because it requires a mathematical operations like <strong>7+7</strong>, etc and not the random alphabets and special characters.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*juM6oUT_Iu9EuzGuyde76w.png" /></figure><p>Now here I was little bit stuck because I have read many writeups based on simple calc by googling the same. But afterwards I got one idea why not I should check Network tab for what’s happening behind the scenes. So I tried simple math addition between numbers and I got the following output in the Network Tab :</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*SigS10bZS_TARUMZAteIfw.png" /></figure><p>So now it’s clear that I have to exploit nodejs whereby nodejs has a extensive math library called <strong>math.js</strong>. So ultimately I have to exploit <strong>math.js</strong> in short with some payloads which return output as &quot;[Object][object]&quot;. So I googled for <strong>math.js</strong> exploit on Google and I found this as output as google search results :</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*ehEP6CODZcR101zY-vsPaw.png" /></figure><p>I used <a href="https://jwlss.pw/mathjs/">https://jwlss.pw/mathjs</a> for exploiting <strong>math.js</strong> library. So I read the context and applied the same to web application from the blog post. Now from the article I can relate that <strong>math.js</strong> has a vulnerability of Remote Code Execution so let’s get our hands dirty and exploit the <strong>math.js</strong> library through our web application and solve the challenge successfully. Also I noticed further that &quot;query=&quot;is vulnerable and so I can exploit it by using the payloads which was mentioned in the article which I have read earlier.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*BU6i_4Yonu4Jw9cwGL8vqA.png" /></figure><p>Now I will make my hands dirty and exploit query field by passing this as payload &quot;cos.constructor(\&quot;return process.env\&quot;)()&quot; and let’s see what we get as output :</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*LrT3B7jCEDmC6WEN6IY6Cg.png" /><figcaption>Request for changing query field content</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*xLoIaOYRTuT40YMceerCMA.png" /><figcaption>Request after sending the payload in query field</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*h0Pw0D7ihPd7pe5AsRBMSw.png" /><figcaption>Response after sending payload in the query field</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*MCsJMeN7QUw5nH3mLvZEpw.png" /><figcaption>Finally flag for EasyCalc was captured</figcaption></figure><p>Voila we have successfully solved all the web challenges. Now it’s time to solve challenges from Network category.</p><p>— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><blockquote><strong><em>Network Category :-</em></strong></blockquote><h4><strong><em>Mistake-1:-</em></strong></h4><figure><img alt="" src="https://cdn-images-1.medium.com/max/544/1*PBVhGeIjirqNpziX8NQb0w.png" /><figcaption>Mistake -1 Challenge Description</figcaption></figure><p>Let’s start with <strong>Mistake-1</strong> from <strong>Network category</strong>. First things first I visited the provided link to the challenge and I land at this page which is as under:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*IeG-vCUeLVxbvy-iRdeB1A.png" /><figcaption>Landing page of <a href="https://mistake.payatu.lol">https://mistake.payatu.lol</a></figcaption></figure><p>By exploring the website for quite sometime, I noticed that it’s a static page which seems like a normal portfolio page of a user. I quickly checked the functionality of the page whether any content is clickable or not and I found that some content is clickable and some isn’t. So I figured out that home page, about me, etc is clickable whereas when I click on social media handles like Twitter, Facebook, Google+ and Linkedin turns out to be unclickable as it is an unclickable content but interestingly I found that except for social media handles there also possess GitLab handle which points the link to the GitLab account of the user named <strong>Sad Detail</strong>.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*fPDzUZB-WfdGiO32RfmoCQ.png" /><figcaption>Clicking on social media handles such as Twitter,Facebook,Google+ and Linkedin turns out to be nothing interesting</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*yI0UAIkByzTpCjT7QEnLbw.png" /><figcaption>But apart from social handles,GitLab has a link to visit to <a href="https://gitlab.com/saddetail">https://gitlab.com/saddetail</a></figcaption></figure><p>Let’s visit the GitLab link which points to user<strong> Sad Detail’</strong>s GitLab account. By visiting the user account I found that there is only one single repository which is his my-portfolio as it is also hosted on the website from which I came from.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*WXlpEsOoKcRJTXT4y72xhw.png" /><figcaption>By visiting GitLab page,we got the GitLab user named Sad Detail</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*WXlpEsOoKcRJTXT4y72xhw.png" /><figcaption>The user named Sad Detail possess only one repository named my-portfolio in his GitLab account</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*OxV8sDJJ7PGjT7bxPbOsiw.png" /><figcaption>Overview of GitLab repository named my-portfolio</figcaption></figure><p>Let’s explore my-portfolio repository of user<strong> Sad Detail</strong>, so I was greeted with these files and folders in his repository. So I got one idea that as GitHub and GitLab possess similar functionality of managing commits by maintaining commit logs so why not explore the history of the commit from the starting point. So I just clicked the repository name and then I clicked history and thus I was greeted with more commits which are older than the present one which I was currently on.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*fKrpXZj0Whrobw-TopqQwA.png" /><figcaption>Clicking on my-portfolio</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*KefGPmsClf6SS_wWhB4Img.png" /><figcaption>Clicking on history to view the other commits for the repository</figcaption></figure><p>The following screenshot shows the order of commits that were created by the user <strong>Sad Detail</strong> for their my-portfolio repository. I noticed that one commit seems to be useful among 8 commits that were made in total. The commit that was interesting according to me was “damn, never thought people at NULLCON would crack it so easily. My security…” as I marked the keyword &quot;NULLCON&quot; in the commit description.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*-t1he57o2IKpzvgrkXcR0Q.png" /><figcaption>Order of commits which are made for my-portfolio repository</figcaption></figure><p>Luckily I got my instinct correct and it was an interesting commit with some nice changes made.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*--8vHA8PTvKxnSpO1QvBdw.png" /><figcaption>Clicking on damn, never thought people at NULLCON would crack it so easily. My security consultant friends were right commit to look further what’s inside and what were the changes made</figcaption></figure><p>After exploring the <strong>NULLCON</strong> keyword commit, I was greeted with some nice 6 deletions and 0 deletions in the index.html file.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*x7K65HUOwgzfVoKL6EKIWQ.png" /><figcaption>At first glance, we see that there is one index.html file which contains some interesting content with 6 deletions and 0 additions</figcaption></figure><p>Looking closer to the <strong>index.html</strong> file, I found that there is some base64 encoded string commented in the file which might be useful. So I copied that string for future use in Sublime Text editor.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*0dPgbuR3W_AHkx3zobc-aw.png" /><figcaption>Base64 encoded string</figcaption></figure><p>Without wasting any time I spinned up <strong>CyberChef</strong> on the browser and I just pasted the string which I copied earlier into the input field with some proper formatting. Voila when I pasted the string I got a suggestion from a <strong>CyberChef</strong> that it is definitely a <strong>base64 encoded string</strong> which can be decoded as a normal string.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*Mr5eQ3FCArNZ33IYFKpxNg.png" /><figcaption>Placing base64 encoded in CyberChef for decoding it</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*t1bAFyKUnIXkXqbkceNGvA.png" /><figcaption>After decoding base64 string</figcaption></figure><p>After decoding the <strong>base64 encoded string</strong>, I got the following message as the output shown below:</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/970/1*sdwkWYAsTuhtOo0BQa-_Tw.png" /><figcaption>Message after decoding from base64 string</figcaption></figure><p>Now what to do next after getting this message. So I first thought that this must be it for the challenge so I submitted the flag as &quot;flag{take-a-few-pages-from-my-book}&quot;. But sadly it was not as expected as in the challenge description there was some interesting note given by the challenge author and also it’s a Network category challenge so the flag might be incorrect in that respect.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/544/1*PBVhGeIjirqNpziX8NQb0w.png" /></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/544/1*Mba6qzWtJraGpNx37KBkNQ.png" /></figure><p>By reading the note mentioned in the challenge description, I again picked the two keywords which were <strong>Room no. 22</strong> and <strong>Room no. 9922</strong> which ultimately states that <strong>Room no.22</strong> is under repair aka <strong>SSH</strong> Default <strong>port 22</strong> is under repair whereas you can check <strong>Room no. 9922</strong> instead states that it was an another <strong>SSH</strong> port in exception of <strong>SSH</strong> default <strong>port 22</strong>. Wait what! I was puzzled at that moment. So I just checked <strong>port 9922</strong> real quick by visiting it by appending to the actual website which in turn result into like this as under :</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*TCGuhvT52pFwiqQrxiucqg.png" /><figcaption>It was redirected to ssh version information and then it was a connection reset</figcaption></figure><p>For further enumeration we can also check via <strong>nmap</strong> (<strong>Network Mapper Tool</strong>) use for scanning ports and services. Thus I concluded that <strong>port 9922</strong> is a ssh port open for ssh login.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*Kuaqezn14-8-fwUkaCDkTg.png" /><figcaption>Nmap result</figcaption></figure><p>So I move further and tried to login via ssh. But wait what should be the credentials for ssh login? So I just visited my notes again what I have so far in my notes to be use for ssh login. So while reading I found that the message which I got at the time of decoding the <strong>base64 string</strong> via <strong>CyberChef</strong> was pointing somewhere around password. So I thought there is a password present in the message which I found in the following screenshot :</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*pYqw_nH1WwNUHa5RLHoKjA.png" /><figcaption>Password for user Sad Detail found from one of GitLab commits</figcaption></figure><blockquote>So voila I made a <strong>username:password</strong> pair and thus I got &quot;saddetail:take-a-few-pages-from-my-book&quot; as a <strong>successful password pair</strong> and I achieved a <strong>successful</strong> <strong>login</strong> in a <strong>ssh session</strong>.</blockquote><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*XIGj6tJj_z-BM4br3H20VA.png" /><figcaption>Successful Login with the creds <strong>saddetail:take-a-few-pages-from-my-book</strong></figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*j29nLMCftoAOMH1Y-488iQ.png" /><figcaption><strong>ls</strong> command not found error as the shell is rbash</figcaption></figure><p>After logging in,I tried to enumerate the file system for finding the flag by using directory listing command &quot;ls&quot; but it failed and it simply throws an error of command not found. So I was little stuck here on how to move further. Also I observed something weird from the command not found error that it is a restrictive bash shell as it throws an error when I typed &quot;ls&quot;in the terminal and not the normal bash shell. So I decided to take a reference from my writeup on <strong>Recovery room</strong> on <strong>TryHackMe</strong> where there was a similar scenario.</p><p><a href="https://github.com/Bornunique911/THM-Recovery">GitHub - Bornunique911/THM-Recovery</a></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*pwgzmfJRf6yFtROkBFKmYA.png" /><figcaption>Taking TryHackMe room named <a href="https://tryhackme.com/room/recovery"><strong>Recovery</strong></a> writeup made by me as a reference</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*F7c_rGdpuhZ9E-s0Lg3NHg.png" /><figcaption>It gives me an error as it is not a normal bash shell but a rbash shell aka restricted bash shell</figcaption></figure><p>So by taking the reference from my writeup, I exited the ssh session and I tried to append &quot;/bin/bash&quot; in the ssh command shown in the screenshot above and it failed.</p><blockquote><strong>ssh saddetail@mistake.payatu.lol -p 9922 &quot;/bin/bash&quot;</strong></blockquote><p>So I got another idea like what if I try to run a directory listing command &quot;ls -la&quot; by appending it in the ssh command.</p><blockquote><strong>ssh saddetail@mistake.payatu.lol -p 9922 “ls -la”</strong></blockquote><p>Voila it got successful finally and I get the listing of the files and directories including flag.txt file. For further step, for capturing the Mistake-1 flag, I just append to the previous command &quot;ls -la;cat flag.txt&quot;</p><blockquote><strong>ssh saddetail@mistake.payatu.lol -p 9922 “ls -la;cat flag.txt”</strong></blockquote><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*-7bDhSIAy_k0FZ1LtJdo8A.png" /><figcaption>It was successful when I tried directory listing of files and directories</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*EgH8fNWgBdI84_Hh6AcF8Q.png" /><figcaption>Also I got a flag file while directory listing</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*ZKzpx-KmwVXic_Ca7Z1ulg.png" /><figcaption>Finally flag for Mistake-1 challenge was captured</figcaption></figure><p>Voila after executing the above command, I successfully got the Mistake-1 flag.</p><p>— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><h4>Mistake-2 :-</h4><figure><img alt="" src="https://cdn-images-1.medium.com/max/546/1*rUYpnEsxFiTWJxCgpD0Aug.png" /><figcaption>Mistake-2 Challenge Description</figcaption></figure><p>As I captured the <strong>Mistake-1</strong> flag, I moved further with <strong>Mistake-2</strong> challenge from the <strong>Network category</strong>. Let’s start.</p><p>In <strong>Mistake-1</strong>, I got the flag from the user’s home directory without entering into a ssh session. So I thought now in <strong>Mistake-2 </strong>challenge, I have to escalate the privileges to root. So I have to logged into a stable ssh session for privilege escalation as the ssh session shell is rbash. In simple words, I have to escape rbash shell in the ssh session to bash shell. So to do that I searched for all the possible results for rbash shell escaping via Google Search but none work except for one which is as under:</p><p><a href="https://oscpnotes.infosecsanyam.in/My_OSCP_Preparation_Notes--Enumeration--SSH--rbash_shell_esacping.html">rbash shell esacping</a></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/891/1*8NBlQaZaYgfKL2CizN1WWw.png" /><figcaption>Steps to escape rbash shell</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*RwBHcP-yI15yR2Se957SQw.png" /><figcaption>Successfully entered into a bash shell by the steps mentioned</figcaption></figure><blockquote>So as I have entered a bash shell then I can simply run &quot;sudo -l&quot; and the result for the same is as follows:</blockquote><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*8vW2h5kDiqPCs9SFTonDPA.png" /><figcaption>Privilege Escalation To Root “sudo -l” output</figcaption></figure><blockquote>As I observed that <strong>SETENV</strong> is enabled,I can change the root user’s environment variables.</blockquote><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*MkJtH46dGazU6PoF0jDLYw.png" /><figcaption>Contents of script.py</figcaption></figure><blockquote>From the above script.py, I observed that it is a simple calculator. As I can change the environment of root user, let’s make our own python library and add it to the &quot;PATH&quot; variable for execution. Let’s change directory to &quot;/tmp&quot;<strong><em> </em></strong>. As os library is called first, so let’s craft it.</blockquote><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*ocHuH6Ho9oZi9bPqsFT5PQ.png" /><figcaption>Finally for Mistake-2 challenge was captured</figcaption></figure><p>Voila I successfully rooted the challenge by using library hijacking for privilege escalation to root.</p><p>— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><p>Thank you so much everyone for reading this blog till the end.</p><p>Peace !!!</p><p>— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><blockquote><strong><em>References :-</em></strong></blockquote><ul><li><a href="https://github.com/sqlmapproject/sqlmap">GitHub - sqlmapproject/sqlmap: Automatic SQL injection and database takeover tool</a></li><li><a href="https://github.com/appsecco/dvna/blob/master/docs/solution/a9-using-components-with-known-vulnerability.md">dvna/a9-using-components-with-known-vulnerability.md at master · appsecco/dvna</a></li><li><a href="https://jwlss.pw/mathjs/">How we exploited a remote execution vulnerability in math.js</a></li><li><a href="https://ctftime.org/writeup/11014">CTFtime.org / HackIT CTF 2018 / Believer Case / Writeup</a></li><li><a href="https://ctftime.org/writeup/10895">CTFtime.org / TokyoWesterns CTF 4th 2018 / Shrine / Writeup</a></li><li><a href="https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection">SSTI (Server Side Template Injection)</a></li></ul><p><a href="https://jinja.palletsprojects.com/en/2.11.x/api/#exceptions">https://jinja.palletsprojects.com/en/2.11.x/api/#exceptions</a></p><ul><li><a href="https://gitlab.com/saddetail/">Sad Detail · GitLab</a></li><li><a href="https://gchq.github.io/CyberChef/">CyberChef</a></li></ul><p><a href="https://tryhackme.com/room/recovery">https://tryhackme.com/room/recovery</a></p><ul><li><a href="https://github.com/Bornunique911/THM-Recovery">GitHub - Bornunique911/THM-Recovery</a></li><li><a href="https://oscpnotes.infosecsanyam.in/My_OSCP_Preparation_Notes--Enumeration--SSH--rbash_shell_esacping.html">rbash shell esacping</a></li><li><a href="https://www.hackingarticles.in/linux-privilege-escalation-python-library-hijacking/">Linux Privilege Escalation: Python Library Hijacking - Hacking Articles</a></li></ul><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=87de06310e6d" width="1" height="1" alt="">
